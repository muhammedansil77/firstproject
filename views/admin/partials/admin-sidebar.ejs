<%
// ---- SAFE HELPER SO `current` CAN BE UNDEFINED ----
const safeCurrent = (typeof current === 'undefined' || current === null)
  ? ''
  : current;
%>

<aside class="admin-sidebar" id="adminSidebar">
  <!-- Logo Area -->
  <div class="sidebar-header">
    <a href="/admin" class="logo">
      <div class="logo-icon">L</div>
      <div>
        <div class="logo-text">LuxTime</div>
        <div class="logo-subtext">ADMIN</div>
      </div>
    </a>
  </div>

  <!-- Navigation -->
  <nav class="sidebar-nav">
    <!-- Main Section -->
    <div class="nav-section">
      <div class="nav-section-title">Overview</div>
      
  <a href="/admin/reports/dash" class="nav-link <%= safeCurrent === 'dashboard' ? 'active' : '' %>">
        <div class="nav-icon">
          <i class="fas fa-tachometer-alt"></i>
        </div>
        <span>Dashboard</span>
      </a>

      <a href="/admin/reports/sales" class="nav-link <%= safeCurrent === 'analytics' ? 'active' : '' %>">
        <div class="nav-icon">
          <i class="fas fa-chart-line"></i>
        </div>
        <span>Analytics</span>
       
      </a>
    </div>

    <!-- Commerce Section -->
    <div class="nav-section">
      <div class="nav-section-title">Commerce</div>
      
    <a href="/admin/orders" class="nav-link <%= safeCurrent === 'orders' ? 'active' : '' %>">

        <div class="nav-icon">
          <i class="fas fa-shopping-bag"></i>
        </div>
        <span>Orders</span>
       
      </a>

      <a href="/admin/product" class="nav-link <%= safeCurrent === 'products' ? 'active' : '' %>">
        <div class="nav-icon">
          <i class="fas fa-box"></i>
        </div>
        <span>Products</span>
    
      </a>

      <a href="/admin/category" class="nav-link <%= safeCurrent === 'category' ? 'active' : '' %>">
        <div class="nav-icon">
          <i class="fas fa-tags"></i>
        </div>
        <span>Categories</span>
      </a>

      <a href="/admin/users" class="nav-link <%= safeCurrent === 'users' ? 'active' : '' %>">
        <div class="nav-icon">
          <i class="fas fa-users"></i>
        </div>
        <span>Customers</span>
       
      </a>
      <a href="/admin/offers" class="nav-link <%= safeCurrent === 'users' ? 'active' : '' %>">
        <div class="nav-icon">
          <i class="fas fa-users"></i>
        </div>
        <span>Offer</span>
       
      </a>
      <a href="/admin/coupons" class="nav-link <%= safeCurrent === 'users' ? 'active' : '' %>">
        <div class="nav-icon">
          <i class="fas fa-users"></i>
        </div>
        <span>Coupons</span>
 
      </a>
         <a href="/admin/returns" class="nav-link <%= safeCurrent === 'users' ? 'active' : '' %>">
        <div class="nav-icon">
          <i class="fas fa-users"></i>
        </div>
        <span>Return</span>
     
      </a>
    </div>
  </nav>

  <!-- Sidebar Footer -->
  <div class="sidebar-footer">
    <!-- User Profile -->
    <div class="user-profile">
      <div class="user-avatar">AJ</div>
      <div class="user-info">
        <div class="user-name">Admin User</div>
        <div class="user-role">Super Admin</div>
      </div>
      <i class="fas fa-chevron-down" style="color: #9ca3af; font-size: 12px;"></i>
    </div>

    <!-- Logout -->
   <a href="javascript:void(0)" onclick="confirmAdminLogout()" class="logout-link">

      <div class="nav-icon">
        <i class="fas fa-sign-out-alt"></i>
      </div>
      <span>Logout</span>
    </a>
  </div>
</aside>

<style>
  .admin-sidebar {
    width: 260px;
    min-width: 260px;
    background: #ffffff;
    border-right: 1px solid #e5e7eb;
    display: flex;
    flex-direction: column;
    height: 100vh;
    position: sticky; /* stays in place while scrolling */
    top: 0;
    z-index: 100;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    transition: all 0.2s ease;
  }

  .sidebar-header {
    padding: 24px;
    border-bottom: 1px solid #f3f4f6;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
  }

  .logo-icon {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 700;
    font-size: 18px;
  }

  .logo-text {
    font-size: 20px;
    font-weight: 700;
    color: #111827;
  }

  .logo-subtext {
    font-size: 11px;
    color: #9ca3af;
    font-weight: 500;
    letter-spacing: 0.5px;
  }

  .sidebar-nav {
    padding: 24px 16px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
    overflow-y: auto;
  }

  .nav-section {
    margin-bottom: 24px;
  }

  .nav-section:last-child {
    margin-bottom: 0;
  }

  .nav-section-title {
    font-size: 11px;
    font-weight: 600;
    color: #9ca3af;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 0 12px 8px;
    margin-bottom: 4px;
  }

  .nav-link {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    border-radius: 8px;
    color: #6b7280;
    text-decoration: none;
    transition: all 0.2s ease;
    font-weight: 500;
    position: relative;
    border: 1px solid transparent;
  }

  .nav-link:hover {
    background: #eff6ff;
    color: #2563eb;
    border-color: #e5e7eb;
  }

  .nav-link.active {
    background: #eff6ff;
    color: #2563eb;
    border-color: #3b82f6;
  }

  .nav-link.active::before {
    content: '';
    position: absolute;
    left: -1px;
    top: 50%;
    transform: translateY(-50%);
    width: 3px;
    height: 60%;
    background: #3b82f6;
    border-radius: 0 2px 2px 0;
  }

  .nav-icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #6b7280;
  }

  .nav-link:hover .nav-icon,
  .nav-link.active .nav-icon {
    color: #2563eb;
  }

  .badge {
    margin-left: auto;
    padding: 2px 8px;
    background: #3b82f6;
    color: white;
    font-size: 10px;
    font-weight: 600;
    border-radius: 10px;
    min-width: 20px;
    text-align: center;
  }

  .badge.new {
    background: #10b981;
  }

  .sidebar-footer {
    margin-top: auto;
    padding: 16px;
    border-top: 1px solid #f3f4f6;
  }

  .user-profile {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    border-radius: 8px;
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    margin-bottom: 12px;
  }

  .user-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 14px;
  }

  .user-info {
    flex: 1;
  }

  .user-name {
    font-size: 14px;
    font-weight: 600;
    color: #111827;
    margin-bottom: 2px;
  }

  .user-role {
    font-size: 12px;
    color: #9ca3af;
  }

  .logout-link {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px;
    border-radius: 8px;
    color: #ef4444;
    text-decoration: none;
    transition: all 0.2s ease;
    font-weight: 500;
    background: rgba(239, 68, 68, 0.05);
    border: 1px solid rgba(239, 68, 68, 0.1);
  }

  .logout-link:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #ef4444;
  }

  @media (max-width: 992px) {
    .admin-sidebar {
      position: fixed;
      left: -260px;
      top: 0;
      transform: translateX(0);
    }
    .admin-sidebar.show {
      transform: translateX(260px);
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
  const currentPath = window.location.pathname;
  const navLinks = document.querySelectorAll('.nav-link');
  
  navLinks.forEach(link => {
    const href = link.getAttribute('href');
    
    // Exact match for dashboard
    if (currentPath === '/admin' || currentPath === '/admin/') {
      if (href === '/admin/dashboard') {
        link.classList.add('active');
      }
    }
    
    // Match for other pages
    if (href !== '/admin/dashboard' && currentPath.startsWith(href)) {
      link.classList.add('active');
    }
    
    // Special handling for analytics/reports
    if (href === '/admin/reports/sales' && currentPath.includes('/admin/reports/')) {
      link.classList.add('active');
    }
  });
});
  // Mobile sidebar toggle (needs a button with id="sidebarToggle" in header)
  document.addEventListener('DOMContentLoaded', function() {
    const sidebarToggle = document.getElementById('sidebarToggle');
    const adminSidebar = document.getElementById('adminSidebar');

    if (sidebarToggle && adminSidebar) {
      sidebarToggle.addEventListener('click', () => {
        adminSidebar.classList.toggle('show');
      });
    }

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 992) {
        if (adminSidebar && !adminSidebar.contains(e.target) &&
            sidebarToggle && !sidebarToggle.contains(e.target)) {
          adminSidebar.classList.remove('show');
        }
      }
    });
  });

function confirmAdminLogout() {
  Swal.fire({
    title: 'Confirm Logout',
    html: `
      <p class="mb-2">Are you sure you want to log out?</p>
      <small class="text-muted">Admin session will be ended.</small>
    `,
    icon: 'warning',
    showCancelButton: true,
    confirmButtonText: 'Yes, Logout',
    cancelButtonText: 'Cancel',
    confirmButtonColor: '#ef4444', // red for admin
    cancelButtonColor: '#6b7280',
    reverseButtons: true
  }).then((result) => {
    if (result.isConfirmed) {
      Swal.fire({
        title: 'Logging out...',
        allowOutsideClick: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      setTimeout(() => {
        window.location.href = '/admin/logout';
      }, 700);
    }
  });
}


</script>
