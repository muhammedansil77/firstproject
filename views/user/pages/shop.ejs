<main class="min-h-screen bg-gradient-to-br from-[#0a0a0a] via-[#0f0f0f] to-[#1a1a1a] text-white antialiased">
   <div class="w-full bg-gradient-to-r from-[#0b0b0b] to-[#151515] border-y border-[#2a2a2a]">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <nav class="py-4" aria-label="Breadcrumb">
        <ol class="flex items-center space-x-2 text-sm">
          <li>
            <a href="/user" class="text-gray-400 hover:text-[#d4af37] transition-colors flex items-center gap-1">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
              </svg>
              Home
            </a>
          </li>
         
          </li>
        </ol>
      </nav>
    </div>
  </div>
  <div class="w-full px-4 sm:px-8 lg:px-16 xl:px-24 py-12 lg:py-16">
    <!-- Toast -->
<div id="toast"
     class="hidden fixed top-6 right-6 z-50 bg-red-600/90 text-white px-5 py-3 rounded-lg shadow-lg backdrop-blur">
  <p id="toast-msg" class="text-sm font-medium"></p>
</div>


    <!-- Page Header -->
    <div class="max-w-7xl mx-auto mb-12 lg:mb-16">
      <div class="relative">
        <!-- Decorative Border -->
        <div class="absolute -top-6 left-0 right-0 h-px bg-gradient-to-r from-transparent via-[#d4af37]/30 to-transparent"></div>
        
        <h1 class="text-4xl lg:text-5xl font-bold mb-4">
          <span class="bg-gradient-to-r from-white via-gray-300 to-gray-500 bg-clip-text text-transparent">Premium</span>
          <span class="text-[#d4af37] ml-2">Collection</span>
        </h1>
        
        <p class="text-gray-400 text-sm tracking-wider uppercase mb-6">Discover Timeless Luxury & Craftsmanship</p>
        
        <!-- Stats -->
        <div class="flex flex-wrap gap-6 lg:gap-10 mt-8">
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-[#d4af37]/10 flex items-center justify-center">
              <svg class="w-4 h-4 text-[#d4af37]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
              </svg>
            </div>
            <div>
              <p class="text-sm text-gray-500">Products</p>
              <p class="text-xl font-semibold text-white"><%= (products || []).length %>+</p>
            </div>
          </div>
          
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-[#d4af37]/10 flex items-center justify-center">
              <svg class="w-4 h-4 text-[#d4af37]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
            </div>
            <div>
              <p class="text-sm text-gray-500">Price Range</p>
              <p class="text-xl font-semibold text-white">₹999 - ₹99,999</p>
            </div>
          </div>
          
          <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-full bg-[#d4af37]/10 flex items-center justify-center">
              <svg class="w-4 h-4 text-[#d4af37]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <div>
              <p class="text-sm text-gray-500">Premium Quality</p>
              <p class="text-xl font-semibold text-white">Certified</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Grid -->
    <div class="flex flex-col lg:flex-row gap-8 lg:gap-12">

      <!-- Filters Sidebar -->
      <aside class="lg:w-72">
        <div class="sticky top-24 space-y-8">
          
          <!-- Filter Header -->
          <div class="flex justify-between items-center">
            <h3 class="text-sm font-semibold tracking-[0.15em] text-white">FILTERS</h3>
            <button onclick="clearAllFilters()" 
                    class="text-xs tracking-[0.1em] text-gray-500 hover:text-[#d4af37] transition duration-300 uppercase">
              Clear All
            </button>
          </div>

          <!-- Category Filter -->
          <div class="pb-6 border-b border-[#2a2a2a]">
            <label class="text-xs font-semibold tracking-[0.15em] text-gray-400 mb-4 block uppercase">Category</label>
            <select id="category-select" onchange="applyFilter()" 
                    class="w-full px-4 py-3 rounded-xl bg-[#0b0b0b]/50 border border-[#2a2a2a] text-sm text-white hover:border-[#d4af37]/50 focus:border-[#d4af37] focus:outline-none transition duration-300 backdrop-blur">
              <option value="all">All Categories</option>
              <% (categories || []).forEach(cat => { %>
                <option value="<%= cat._id %>" 
                        <%= query.category === String(cat._id) ? 'selected' : '' %>>
                  <%= cat.name %>
                </option>
              <% }) %>
            </select>
          </div>

          <!-- Price Range -->
          <div class="pb-6 border-b border-[#2a2a2a]">
            <label class="text-xs font-semibold tracking-[0.15em] text-gray-400 mb-4 block uppercase">Price Range</label>
            
            <!-- Range Slider -->
            <div class="mb-6 px-2">
              <div class="relative pt-6">
                <input type="range" id="price-slider" min="0" max="50000" step="500" 
                       class="w-full h-1 bg-[#2a2a2a] rounded-lg appearance-none cursor-pointer slider-track">
                <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-[#d4af37]/30 to-[#d4af37] rounded-lg pointer-events-none"></div>
              </div>
              <div class="flex justify-between text-xs text-gray-500 mt-2">
                <span>₹0</span>
                <span>₹50,000+</span>
              </div>
            </div>
            
            <!-- Price Inputs -->
            <div class="flex gap-3 mb-4">
              <div class="flex-1">
                <input type="number" id="price-from" placeholder="₹ Min" value="<%= query.min || '' %>"
                       class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-lg text-sm text-white placeholder-gray-600 hover:border-[#d4af37]/50 focus:border-[#d4af37] focus:outline-none transition duration-300"
                       min="0" step="100" />
              </div>
              <div class="flex-1">
                <input type="number" id="price-to" placeholder="₹ Max" value="<%= query.max || '' %>"
                       class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-lg text-sm text-white placeholder-gray-600 hover:border-[#d4af37]/50 focus:border-[#d4af37] focus:outline-none transition duration-300"
                       min="0" step="100" />
              </div>
            </div>
            
            <button onclick="applyFilter()" 
                    class="w-full px-4 py-3 rounded-xl bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black font-semibold text-sm hover:shadow-xl hover:shadow-[#d4af37]/30 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]">
              Apply Price Filter
            </button>
          </div>

          <!-- Quick Ranges -->
          <div>
            <label class="text-xs font-semibold tracking-[0.15em] text-gray-400 mb-4 block uppercase">Quick Selection</label>
            <div class="space-y-3">
              <button onclick="setPrice(0,999)" 
                      class="w-full text-left px-4 py-3 rounded-lg bg-[#0b0b0b]/30 border border-[#2a2a2a] hover:border-[#d4af37] hover:bg-[#d4af37]/5 text-sm text-gray-300 hover:text-[#d4af37] transition-all duration-300 group">
                <div class="flex items-center justify-between">
                  <span>Under ₹999</span>
                  <svg class="w-4 h-4 text-gray-600 group-hover:text-[#d4af37] transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                  </svg>
                </div>
              </button>
              
              <button onclick="setPrice(1000,4999)" 
                      class="w-full text-left px-4 py-3 rounded-lg bg-[#0b0b0b]/30 border border-[#2a2a2a] hover:border-[#d4af37] hover:bg-[#d4af37]/5 text-sm text-gray-300 hover:text-[#d4af37] transition-all duration-300 group">
                <div class="flex items-center justify-between">
                  <span>₹1,000 – ₹4,999</span>
                  <svg class="w-4 h-4 text-gray-600 group-hover:text-[#d4af37] transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                  </svg>
                </div>
              </button>
              
              <button onclick="setPrice(5000,null)" 
                      class="w-full text-left px-4 py-3 rounded-lg bg-[#0b0b0b]/30 border border-[#2a2a2a] hover:border-[#d4af37] hover:bg-[#d4af37]/5 text-sm text-gray-300 hover:text-[#d4af37] transition-all duration-300 group">
                <div class="flex items-center justify-between">
                  <span>₹5,000+ Premium</span>
                  <svg class="w-4 h-4 text-gray-600 group-hover:text-[#d4af37] transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                  </svg>
                </div>
              </button>
            </div>
          </div>
        </div>
      </aside>

      <!-- Products Section -->
      <section class="flex-1">
        
        <!-- Sort and Active Filters -->
        <div class="mb-8">
          <!-- Active Filters -->
          <% if (query.search || query.min || query.max || query.sort || query.category) { %>
            <div class="flex flex-wrap gap-2 mb-6">
              <% if (query.category && categories) { 
                const activeCat = categories.find(c => String(c._id) === query.category);
              %>
                <span class="px-4 py-2 bg-[#d4af37]/10 rounded-full text-xs tracking-widest flex items-center gap-2 border border-[#d4af37]/30">
                  Category: <%= activeCat ? activeCat.name : query.category %>
                  <button onclick="removeFilter('category')" class="text-gray-500 hover:text-[#d4af37] transition">✕</button>
                </span>
              <% } %>
              
              <% if (query.search) { %>
                <span class="px-4 py-2 bg-[#d4af37]/10 rounded-full text-xs tracking-widest flex items-center gap-2 border border-[#d4af37]/30">
                  Search: <%= query.search %> 
                  <button onclick="removeFilter('search')" class="text-gray-500 hover:text-[#d4af37] transition">✕</button>
                </span>
              <% } %>
              
              <% if (query.min || query.max) { %>
                <span class="px-4 py-2 bg-[#d4af37]/10 rounded-full text-xs tracking-widest flex items-center gap-2 border border-[#d4af37]/30">
                  Price: ₹<%= query.min || '0' %> – ₹<%= query.max || '∞' %>
                  <button onclick="removePriceFilter()" class="text-gray-500 hover:text-[#d4af37] transition">✕</button>
                </span>
              <% } %>
              
              <% if (query.sort && query.sort !== '') { 
                let sortName = '';
                switch(query.sort) {
                  case 'latest': sortName = 'New Arrivals'; break;
                  case 'price-asc': sortName = 'Price: Low to High'; break;
                  case 'price-desc': sortName = 'Price: High to Low'; break;
                  case 'a-z': sortName = 'Name: A to Z'; break;
                  case 'z-a': sortName = 'Name: Z to A'; break;
                  default: sortName = 'Best Match';
                }
              %>
                <span class="px-4 py-2 bg-[#d4af37]/10 rounded-full text-xs tracking-widest flex items-center gap-2 border border-[#d4af37]/30">
                  Sort: <%= sortName %>
                  <button onclick="removeFilter('sort')" class="text-gray-500 hover:text-[#d4af37] transition">✕</button>
                </span>
              <% } %>
            </div>
          <% } %>

          <!-- Sort Bar -->
          <div class="flex items-center justify-between bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl p-4 backdrop-blur">
            <div class="flex items-center gap-3">
              <svg class="w-5 h-5 text-[#d4af37]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
              </svg>
              <span class="text-sm text-gray-400">Sort By</span>
            </div>
            <select id="sort-by" onchange="applyFilter()" 
                    class="px-4 py-2 bg-[#0b0b0b] border border-[#2a2a2a] rounded-lg text-sm text-white hover:border-[#d4af37] focus:border-[#d4af37] focus:outline-none transition duration-300 cursor-pointer">
              <option value="" <%= !query.sort || query.sort === '' ? 'selected' : '' %>>Best Match</option>
              <option value="latest" <%= query.sort === 'latest' ? 'selected' : '' %>>New Arrivals</option>
              <option value="price-asc" <%= query.sort === 'price-asc' ? 'selected' : '' %>>Price: Low to High</option>
              <option value="price-desc" <%= query.sort === 'price-desc' ? 'selected' : '' %>>Price: High to Low</option>
              <option value="a-z" <%= query.sort === 'a-z' ? 'selected' : '' %>>Name: A to Z</option>
              <option value="z-a" <%= query.sort === 'z-a' ? 'selected' : '' %>>Name: Z to A</option>
            </select>
          </div>
        </div>

        <!-- Product Grid -->
<!-- Product Grid -->
<% if (products && products.length > 0) { %>
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    <% products.forEach(product => { 
         const imgVal = (Array.isArray(product.images) && product.images.find(x => x)) || null;
        const mainImg = imgVal
  ? (imgVal.startsWith('http') ? imgVal : '/' + imgVal)
  : '/uploads/placeholder.png';

         const priceNum = (product.price !== undefined && product.price !== null)
           ? Number(product.price)
           : (product.minPrice !== undefined && product.minPrice !== null)
             ? Number(product.minPrice)
             : null;
    %>
    
    <div class="group relative">
      <!-- Product Card Container -->
      <div class="relative bg-gradient-to-br from-[#0b0b0b] to-[#151515] rounded-2xl overflow-hidden border border-[#2a2a2a] 
                  hover:border-[#d4af37]/40 hover:shadow-2xl hover:shadow-[#d4af37]/10 transition-all duration-500">
        
        <!-- Image Container -->
        <div class="relative w-full aspect-square overflow-hidden bg-black">
          <img src="<%= mainImg %>" alt="<%= product.name %>" 
               class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
               loading="lazy"
               onerror="this.onerror=null;this.src='/uploads/placeholder.png';this.style.opacity=0.5;" />
          <% const isOutOfStock = product.totalStock === 0; %>

<% if (isOutOfStock) { %>
  <div class="absolute top-4 left-4 bg-gray-900/80 text-white text-xs font-bold px-3 py-1 rounded-full border border-gray-600 z-10">
    OUT OF STOCK
  </div>
<% } %>

          <!-- Overlay Gradient -->
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-60 group-hover:opacity-80 transition-opacity duration-500"></div>
          
          <!-- Quick View Button (Appears on Hover) -->
          <div class="absolute inset-0 flex items-end justify-center pb-6 opacity-0 group-hover:opacity-100 transition-all duration-500 translate-y-4 group-hover:translate-y-0">
            <a href="/user/shop/<%= product._id %>" 
               class="px-5 py-2 bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black text-xs font-semibold tracking-widest rounded-full uppercase shadow-lg hover:shadow-xl hover:shadow-[#d4af37]/30 transition-all duration-300">
              View Details
            </a>
          </div>
          
          <!-- Premium Badge -->
          <% if (priceNum && priceNum > 5000) { %>
            <div class="absolute top-4 left-4 bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black text-xs font-bold px-3 py-1 rounded-full shadow-lg z-10">
              PREMIUM
            </div>
          <% } %>
          
          <!-- OFFER BADGE -->
          <% if (product.offer) { %>
            <div class="absolute top-4 right-4 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg z-10">
              <% if (product.offer.discountType === 'percentage') { %>
                <%= product.offer.discountValue %>% OFF
              <% } else { %>
                ₹<%= product.offer.discountValue %> OFF
              <% } %>
            </div>
          <% } %>
        </div>

        <!-- Product Info -->
        <div class="p-5">
          <!-- Category -->
          <div class="mb-3">
            <span class="text-xs text-[#d4af37]/80 tracking-widest uppercase font-medium">
              <%= product.category?.name || 'LUXURY' %>
            </span>
          </div>
          
          <!-- Name -->
          <h3 class="text-base font-semibold text-white mb-2 line-clamp-2 group-hover:text-[#d4af37] transition-colors duration-300">
            <%= product.name %>
          </h3>
          
          <!-- Description -->
          <p class="text-xs text-gray-500 mb-4 line-clamp-2">
            <%= product.description?.substring(0, 80) || 'Premium luxury timepiece with exquisite craftsmanship' %>...
          </p>

          <!-- Price & Rating -->
          <div class="flex items-center justify-between pt-4 border-t border-[#2a2a2a]">
            <div class="flex items-baseline gap-2">
              <% if (product.offer && priceNum !== null) { %>
                <!-- Original Price -->
                <span class="text-sm text-gray-500 line-through">
                  ₹<%= priceNum.toLocaleString('en-IN') %>
                </span>
                <!-- Discounted Price -->
                <span class="text-xl font-bold text-[#d4af37]">
                  ₹<%= product.offer.finalPrice.toLocaleString('en-IN') %>
                </span>
              <% } else { %>
                <!-- Normal Price -->
                <span class="text-xl font-bold text-[#d4af37]">
                  <% if (priceNum !== null && Number.isFinite(priceNum)) { %>
                    ₹<%= priceNum.toLocaleString('en-IN') %>
                  <% } else { %>
                    —
                  <% } %>
                </span>
              <% } %>
              <span class="text-xs text-gray-500 ml-2">+GST</span>
            </div>
            
            <!-- Rating -->
            <% if (product.avgRating && product.avgRating > 0) { %>
              <div class="flex items-center gap-1 bg-yellow-400/10 px-2 py-1 rounded-full border border-yellow-400/20">
                <span class="text-yellow-400 text-xs font-bold"><%= product.avgRating.toFixed(1) %></span>
                <span class="text-yellow-400 text-xs">★</span>
              </div>
            <% } %>
          </div>

          <!-- Action Buttons -->
          <div class="mt-4 flex gap-3">
            <!-- View Details Button -->
            <a href="/user/shop/<%= product._id %>" 
               class="flex-1 py-2.5 bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black text-sm font-semibold rounded-lg hover:shadow-lg hover:shadow-[#d4af37]/30 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] text-center">
              View Details
            </a>
            
            <!-- Wishlist Button -->
        <!-- Wishlist Button - FIXED VERSION -->
<button 
 <!-- Wishlist Button - CORRECTED VERSION -->
<button 
  onclick="toggleWishlist(
    '<%= product._id %>', 
    <%= product.sampleVariantId ? `'${product.sampleVariantId}'` : null %>, 
    this
  )"
  class="px-4 py-2.5 <%= product.isInWishlist ? 'bg-red-500/20 text-red-400 border border-red-500/40' : 'bg-gray-900/50 text-gray-300 border border-gray-700' %> rounded-lg hover:shadow-lg transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2 group/wishlist"
  title="<%= product.isInWishlist ? 'Remove from wishlist' : 'Add to wishlist' %>"
  <%= (!product.sampleVariantId) ? 'disabled' : '' %>
>

  <% if (product.isInWishlist) { %>
    <!-- Filled Heart (When in Wishlist) -->
    <svg class="w-4 h-4 text-red-500 group-hover/wishlist:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24">
      <path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
    </svg>
    <span class="text-xs font-medium">Saved</span>
  <% } else { %>
    <!-- Outline Heart (When not in Wishlist) -->
    <svg class="w-4 h-4 text-gray-400 group-hover/wishlist:text-red-400 group-hover/wishlist:scale-110 transition-all" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
    </svg>
    <span class="text-xs font-medium text-gray-400 group-hover/wishlist:text-red-400">
      <%= (!product.variants || !product.variants[0]) ? 'WISH' : 'Save' %>
    </span>
  <% } %>
</button>
          </div>
        </div>
      </div>
    </div>
    <% }); %>
  </div>
  
  <!-- Product Count -->
  <div class="mt-8 text-center text-sm text-gray-500">
    Showing <%= products.length %> of <%= pagination?.totalItems || products.length %> products
  </div>
  
<% } else { %>
  <!-- Empty State -->
  <div class="flex flex-col items-center justify-center py-32 bg-gradient-to-br from-[#0b0b0b] to-[#151515] border border-[#2a2a2a] rounded-2xl">
    <div class="w-24 h-24 mb-6 rounded-full bg-[#d4af37]/10 flex items-center justify-center">
      <svg class="w-12 h-12 text-[#d4af37]/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
      </svg>
    </div>
    <h2 class="text-2xl font-light text-gray-300 mb-3">No Products Found</h2>
    <p class="text-gray-500 text-sm mb-8 text-center max-w-md">
      Try adjusting your filters or browse our premium collection.
    </p>
    <button onclick="clearAllFilters()" 
            class="px-8 py-3 rounded-xl bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black font-semibold text-sm hover:shadow-xl hover:shadow-[#d4af37]/20 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]">
      Reset Filters
    </button>
  </div>
<% } %>

<!-- Pagination -->
<% if (pagination && pagination.totalPages > 1) { %>
  <div class="mt-12 pt-8 border-t border-[#2a2a2a]">
    <div class="flex justify-center gap-2">
      <!-- Previous -->
      <% if (pagination.currentPage > 1) { %>
        <button onclick="changePage(<%= pagination.currentPage - 1 %>)"
                class="w-10 h-10 rounded-lg border border-[#2a2a2a] text-gray-400 hover:text-[#d4af37] hover:border-[#d4af37] transition duration-300 flex items-center justify-center">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
        </button>
      <% } %>
      
      <!-- Page Numbers -->
      <% for(let i = 1; i <= pagination.totalPages; i++) { 
          if (i === 1 || i === pagination.totalPages || (i >= pagination.currentPage - 2 && i <= pagination.currentPage + 2)) { %>
        <button onclick="changePage(<%= i %>)"
                class="w-10 h-10 rounded-lg border text-sm font-medium transition-all duration-300
                <%= i === pagination.currentPage 
                  ? 'bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black border-[#d4af37]' 
                  : 'border-[#2a2a2a] text-gray-400 hover:text-[#d4af37] hover:border-[#d4af37]' %>">
          <%= i %>
        </button>
      <% } else if (i === pagination.currentPage - 3 || i === pagination.currentPage + 3) { %>
        <span class="w-10 h-10 flex items-center justify-center text-gray-600">...</span>
      <% } } %>
      
      <!-- Next -->
      <% if (pagination.currentPage < pagination.totalPages) { %>
        <button onclick="changePage(<%= pagination.currentPage + 1 %>)"
                class="w-10 h-10 rounded-lg border border-[#2a2a2a] text-gray-400 hover:text-[#d4af37] hover:border-[#d4af37] transition duration-300 flex items-center justify-center">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
        </button>
      <% } %>
    </div>
  </div>
<% } %>
      </section>
    </div>
  </div>
</main>

<style>
  /* Custom scrollbar */
  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: #d4af37 transparent;
  }
  
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: linear-gradient(to bottom, #d4af37, #b8941f);
    border-radius: 3px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(to bottom, #f4d03f, #d4af37);
  }
  
  /* Price slider styling */
  .slider-track::-webkit-slider-thumb {
    appearance: none;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #d4af37;
    cursor: pointer;
    border: 3px solid #0b0b0b;
    box-shadow: 0 0 0 2px #d4af37;
  }
  
  .slider-track::-moz-range-thumb {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: #d4af37;
    cursor: pointer;
    border: 3px solid #0b0b0b;
    box-shadow: 0 0 0 2px #d4af37;
  }
  
  /* Smooth hover transitions */
  .transition-all {
    transition-property: all;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 300ms;
  }
  
  /* Line clamp */
  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }
</style>

<script>
  // Price slider functionality
  const priceSlider = document.getElementById('price-slider');
  const priceFrom = document.getElementById('price-from');
  const priceTo = document.getElementById('price-to');
  
  if (priceSlider) {
    priceSlider.addEventListener('input', function() {
      const value = this.value;
      const max = this.max;
      const percentage = (value / max) * 100;
      
      // Update gradient
      this.style.background = `linear-gradient(to right, transparent ${percentage}%, #d4af37 ${percentage}%)`;
      
      // Update max price input
      if (priceTo) {
        priceTo.value = value;
      }
    });
    
    // Set initial gradient
    const initialValue = priceSlider.value;
    const max = priceSlider.max;
    const initialPercentage = (initialValue / max) * 100;
    priceSlider.style.background = `linear-gradient(to right, transparent ${initialPercentage}%, #d4af37 ${initialPercentage}%)`;
  }
  
  // Quick price functions
  function setPrice(min, max) {
    const fromInput = document.getElementById('price-from');
    const toInput = document.getElementById('price-to');
    
    if (fromInput) fromInput.value = min || '';
    if (toInput) toInput.value = max || '';
    
    applyFilter();
  }
  
  function removePriceFilter() {
    const fromInput = document.getElementById('price-from');
    const toInput = document.getElementById('price-to');
    
    if (fromInput) fromInput.value = '';
    if (toInput) toInput.value = '';
    
    // Update slider
    if (priceSlider) {
      priceSlider.value = 50000;
      priceSlider.style.background = 'linear-gradient(to right, transparent 100%, #d4af37 100%)';
    }
    
    applyFilter();
  }
</script>