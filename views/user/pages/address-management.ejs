<div id="toast-container" class="fixed top-6 right-6 z-[9999] space-y-3"></div>

<main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="w-full bg-gradient-to-r from-[#0b0b0b] to-[#151515] border-y border-[#2a2a2a]">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <nav class="py-4" aria-label="Breadcrumb">
      <ol class="flex items-center space-x-2 text-sm">
        <li>
          <a href="/user/home" class="text-gray-400 hover:text-[#d4af37] transition-colors flex items-center gap-1">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
            </svg>
            Home
          </a>
          
        </li>
        <li class="flex items-center">
          <svg class="w-4 h-4 mx-1 text-gray-600" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
          </svg>
        </li>
        <li>
          <a href="/user/dashboard" class="text-gray-400 hover:text-[#d4af37] transition-colors">
            Dashboard
          </a>
        </li>
        <li class="flex items-center">
          <svg class="w-4 h-4 mx-1 text-gray-600" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
          </svg>
        </li>
        <li>
          <span class="text-[#d4af37] font-medium" aria-current="page">
            My Addresses
          </span>
        </li>
      </ol>
    </nav>
  </div>
</div>
  <!-- Header -->
<div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8">
    <div>
      <h1 class="text-3xl font-bold text-white">My Addresses</h1>
      <p class="text-gray-400 mt-2">Manage your delivery addresses</p>
    </div>
    
    <button
      onclick="openAddModal()"
      class="inline-flex items-center gap-2 bg-gradient-to-r from-[#d4af37] to-[#b8941f] hover:from-[#e4bf47] hover:to-[#c8a42f] text-black px-5 py-3 rounded-xl font-semibold transition-all duration-200 transform hover:-translate-y-0.5 shadow-lg hover:shadow-xl hover:shadow-[#d4af37]/20">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
      </svg>
      Add New Address
    </button>
  </div>

  <!-- Address List -->
  <% if (addresses.length === 0) { %>
    <div class="text-center py-32 px-4 bg-gradient-to-br from-[#0b0b0b] to-[#151515] border border-[#2a2a2a] rounded-2xl max-w-2xl mx-auto">
      <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-[#d4af37]/10 flex items-center justify-center">
        <svg class="w-12 h-12 text-[#d4af37]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
        </svg>
      </div>
      <h3 class="text-2xl font-light text-gray-300 mb-3">No addresses yet</h3>
      <p class="text-gray-500 mb-8">Add your first address to get started with faster checkouts</p>
      <button
        onclick="openAddModal()"
        class="px-8 py-3 bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black font-semibold rounded-xl 
               hover:shadow-xl hover:shadow-[#d4af37]/20 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]">
        Add Your First Address
      </button>
    </div>
  <% } else { %>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6">
      <% addresses.forEach(addr => { %>
        <div class="group relative bg-gradient-to-br from-[#0b0b0b] to-[#151515] rounded-2xl border-2 <%= addr.isDefault ? 'border-[#d4af37]' : 'border-[#2a2a2a]' %> p-6 transition-all duration-500 hover:border-[#d4af37]/50 hover:shadow-xl hover:shadow-[#d4af37]/5">
          <!-- Default Badge -->
          <% if (addr.isDefault) { %>
            <div class="absolute -top-3 left-6">
              <span class="inline-flex items-center gap-1.5 bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black text-xs font-bold px-4 py-1.5 rounded-full shadow-lg">
                <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                </svg>
                Default Address
              </span>
            </div>
          <% } %>

          <!-- Address Type Icon -->
          <div class="flex items-start justify-between mb-4">
            <div class="flex items-center gap-3">
              <div class="w-12 h-12 rounded-xl <%= addr.addressType === 'home' ? 'bg-[#d4af37]/10 text-[#d4af37]' : addr.addressType === 'work' ? 'bg-[#d4af37]/10 text-[#d4af37]' : 'bg-[#d4af37]/10 text-[#d4af37]' %> flex items-center justify-center">
                <% if (addr.addressType === 'home') { %>
                  <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
                  </svg>
                <% } else if (addr.addressType === 'work') { %>
                  <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z" clip-rule="evenodd"/>
                    <path d="M2 13.692V16a2 2 0 002 2h12a2 2 0 002-2v-2.308A24.974 24.974 0 0110 15c-2.796 0-5.487-.46-8-1.308z"/>
                  </svg>
                <% } else { %>
                  <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                  </svg>
                <% } %>
              </div>
              <div>
                <span class="text-xs font-semibold uppercase tracking-wider text-gray-500">
                  <%= addr.addressType === 'home' ? 'Home' : addr.addressType === 'work' ? 'Work' : 'Other' %>
                </span>
                <h4 class="font-bold text-white"><%= addr.fullName %></h4>
              </div>
            </div>
            
            <!-- Action Menu -->
            <div class="relative">
              <button onclick="toggleAddressMenu('<%= addr._id %>')" 
                      class="p-2 rounded-lg hover:bg-[#1a1a1a] transition-colors group/menu">
                <svg class="w-5 h-5 text-gray-500 group-hover/menu:text-[#d4af37]" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"/>
                </svg>
              </button>
              
              <!-- Dropdown Menu -->
              <div id="menu-<%= addr._id %>" 
                   class="absolute right-0 mt-1 w-48 bg-gradient-to-b from-[#0b0b0b] to-[#151515] rounded-xl shadow-2xl border border-[#2a2a2a] z-10 hidden">
                <div class="py-1">
                  <button onclick='openEditModal(<%- JSON.stringify(addr) %>)' 
                          class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-gray-300 hover:text-[#d4af37] hover:bg-[#1a1a1a] transition-colors">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                    </svg>
                    Edit Address
                  </button>
                  <% if (!addr.isDefault) { %>
                    <form method="POST" action="/user/address/set-default/<%= addr._id %>" class="w-full">
                      <button type="submit" 
                              class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-gray-300 hover:text-[#d4af37] hover:bg-[#1a1a1a] transition-colors">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                        Set as Default
                      </button>
                    </form>
                  <% } %>
               <form method="POST" 
      action="/user/address/delete/<%= addr._id %>" 
      class="w-full">
  <button type="submit" 
          onclick="confirmDelete(event)"
          class="flex items-center gap-3 w-full px-4 py-2.5 text-sm text-red-500 hover:text-red-400 hover:bg-[#1a1a1a] transition-colors">
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
    </svg>
    Delete Address
  </button>
</form>
                </div>
              </div>
            </div>
          </div>

          <!-- Address Details -->
          <div class="space-y-3">
            <div class="flex items-start gap-3">
              <svg class="w-5 h-5 text-[#d4af37]/80 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
              </svg>
              <span class="text-gray-300 font-medium"><%= addr.phone %></span>
            </div>
            
            <div class="flex items-start gap-3">
              <svg class="w-5 h-5 text-[#d4af37]/80 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
              <div class="text-gray-300">
                <p class="font-medium"><%= addr.addressLine1 %></p>
                <% if (addr.addressLine2) { %>
                  <p><%= addr.addressLine2 %></p>
                <% } %>
                <p><%= addr.city %>, <%= addr.state %> - <%= addr.postalCode %></p>
                <p class="font-medium mt-1"><%= addr.country %></p>
              </div>
            </div>
          </div>
        </div>
      <% }); %>
    </div>
  <% } %>

  <!-- ADD ADDRESS MODAL -->
<!-- ADD ADDRESS MODAL - FIXED VERSION -->
<div id="addModal" class="fixed inset-0 bg-black/80 hidden flex items-center justify-center z-50 p-4 backdrop-blur-sm">
  <div class="bg-gradient-to-br from-[#0b0b0b] to-[#151515] w-full max-w-2xl rounded-2xl shadow-2xl border border-[#2a2a2a] animate-modal-in">
    <!-- Modal Header -->
    <div class="flex items-center justify-between p-6 border-b border-[#2a2a2a]">
      <div>
        <h3 class="text-2xl font-bold text-white">Add New Address</h3>
        <p class="text-gray-400 mt-1">Add a new delivery address</p>
      </div>
      <button onclick="closeAddModal()"
              class="p-2 rounded-lg hover:bg-[#1a1a1a] transition-colors">
        <svg class="w-6 h-6 text-gray-400 hover:text-[#d4af37]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
        </svg>
      </button>
    </div>

    <!-- Modal Form -->
    <form method="POST" action="/user/address/add" class="p-6 max-h-[70vh] overflow-y-auto custom-scrollbar">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Full Name -->
        <div>
          <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
            Full Name *
          </label>
          <input type="text" 
                 name="fullName" 
                 placeholder="John Doe" 
                 
                 class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                        focus:border-[#d4af37] focus:outline-none transition duration-300
                        hover:border-[#d4af37]/50">
        </div>

        <!-- Phone -->
      <!-- Primary Phone -->
<div>
  <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
    Primary Phone *
  </label>
  <input type="tel" 
         id="phoneInput" 
         name="phone" 
         
         class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white">
  <input type="hidden" name="countryCode" id="countryCode">
  <p class="text-xs text-gray-500 mt-1">Primary contact number</p>
</div>

<!-- Alternate Phone -->
<div>
  <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
    Alternate Phone
  </label>
  <input type="tel" 
         id="alternatePhoneInput" 
         name="alternatePhone"
         class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white">
  <input type="hidden" name="alternateCountryCode" id="alternateCountryCode">
  <p class="text-xs text-gray-500 mt-1">Must be different from primary phone</p>
</div>


        <!-- Address Line 1 -->
        <div class="md:col-span-2">
          <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
            Address Line 1 *
          </label>
          <input type="text" 
                 name="addressLine1" 
                 placeholder="Street address, P.O. box, company name" 
                 
                 class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                        focus:border-[#d4af37] focus:outline-none transition duration-300
                        hover:border-[#d4af37]/50">
        </div>

        <!-- Address Line 2 -->
        <div class="md:col-span-2">
          <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
            Address Line 2 (Optional)
          </label>
          <input type="text" 
                 name="addressLine2" 
                 placeholder="Apartment, suite, unit, building, floor, etc."
                 class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                        focus:border-[#d4af37] focus:outline-none transition duration-300
                        hover:border-[#d4af37]/50">
        </div>

        <!-- City -->
        <div>
          <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
            City *
          </label>
          <input type="text" 
                 name="city" 
                 placeholder="New York" 
                 
                 class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                        focus:border-[#d4af37] focus:outline-none transition duration-300
                        hover:border-[#d4af37]/50">
        </div>

        <!-- State -->
      <!-- State Dropdown -->
<div>
  <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
    State/Province *
  </label>
  <select name="state" 
          
          class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                 focus:border-[#d4af37] focus:outline-none transition duration-300
                 hover:border-[#d4af37]/50 appearance-none cursor-pointer">
    <option value="" class="bg-[#0b0b0b] text-gray-400">Select State</option>
    <option value="Alabama" class="bg-[#0b0b0b] text-white">Alabama</option>
    <option value="Alaska" class="bg-[#0b0b0b] text-white">Alaska</option>
    <option value="Arizona" class="bg-[#0b0b0b] text-white">Arizona</option>
    <option value="Arkansas" class="bg-[#0b0b0b] text-white">Arkansas</option>
    <option value="California" class="bg-[#0b0b0b] text-white">California</option>
    <!-- Add more states as needed -->
  </select>
</div>

        <!-- Postal Code -->
      <!-- Postal Code -->
<div>
  <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
    Postal Code *
  </label>
  <input type="text" 
         name="postalCode" 
         placeholder="10001" 
         
         pattern="^\d{5}$"
         title="Postal code must be exactly 5 digits"
         maxlength="5"
         oninput="this.value = this.value.replace(/[^0-9]/g, '')"
         class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                focus:border-[#d4af37] focus:outline-none transition duration-300
                hover:border-[#d4af37]/50">
  <p class="text-xs text-gray-500 mt-1">Exactly 5 digits </p>
</div>

        <!-- Country -->
        <div>
          <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
            Country *
          </label>
          <select name="country" 
                  
                  class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                         focus:border-[#d4af37] focus:outline-none transition duration-300
                         hover:border-[#d4af37]/50 appearance-none cursor-pointer">
            <option value="" class="bg-[#0b0b0b] text-gray-400">Select Country</option>
            <option value="United States" class="bg-[#0b0b0b] text-white">United States</option>
            <option value="Canada" class="bg-[#0b0b0b] text-white">Canada</option>
            <option value="United Kingdom" class="bg-[#0b0b0b] text-white">United Kingdom</option>
            <option value="Australia" class="bg-[#0b0b0b] text-white">Australia</option>
            <option value="India" class="bg-[#0b0b0b] text-white">India</option>
          </select>
        </div>

        <!-- Address Type -->
        <div class="md:col-span-2">
          <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
            Address Type
          </label>
          <div class="grid grid-cols-3 gap-3">
            <label class="relative">
              <input type="radio" name="addressType" value="home" class="sr-only peer" checked>
              <div class="flex flex-col items-center p-4 border-2 border-[#2a2a2a] rounded-xl cursor-pointer transition-all duration-300 
                         peer-checked:border-[#d4af37] peer-checked:bg-[#d4af37]/5 peer-checked:text-[#d4af37] hover:border-[#d4af37]/50">
                <svg class="w-8 h-8 mb-2 text-gray-500 peer-checked:text-[#d4af37]" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
                </svg>
                <span class="text-sm font-medium text-gray-300 peer-checked:text-[#d4af37]">Home</span>
              </div>
            </label>
            
            <label class="relative">
              <input type="radio" name="addressType" value="work" class="sr-only peer">
              <div class="flex flex-col items-center p-4 border-2 border-[#2a2a2a] rounded-xl cursor-pointer transition-all duration-300 
                         peer-checked:border-[#d4af37] peer-checked:bg-[#d4af37]/5 peer-checked:text-[#d4af37] hover:border-[#d4af37]/50">
                <svg class="w-8 h-8 mb-2 text-gray-500 peer-checked:text-[#d4af37]" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z" clip-rule="evenodd"/>
                  <path d="M2 13.692V16a2 2 0 002 2h12a2 2 0 002-2v-2.308A24.974 24.974 0 0110 15c-2.796 0-5.487-.46-8-1.308z"/>
                </svg>
                <span class="text-sm font-medium text-gray-300 peer-checked:text-[#d4af37]">Work</span>
              </div>
            </label>
            
            <label class="relative">
              <input type="radio" name="addressType" value="other" class="sr-only peer">
              <div class="flex flex-col items-center p-4 border-2 border-[#2a2a2a] rounded-xl cursor-pointer transition-all duration-300 
                         peer-checked:border-[#d4af37] peer-checked:bg-[#d4af37]/5 peer-checked:text-[#d4af37] hover:border-[#d4af37]/50">
                <svg class="w-8 h-8 mb-2 text-gray-500 peer-checked:text-[#d4af37]" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                </svg>
                <span class="text-sm font-medium text-gray-300 peer-checked:text-[#d4af37]">Other</span>
              </div>
            </label>
          </div>
        </div>

        <!-- Set as Default -->
        <div class="md:col-span-2">
          <label class="flex items-center gap-3 p-4 border border-[#2a2a2a] rounded-xl cursor-pointer hover:bg-[#1a1a1a] transition-all duration-300 group/checkbox">
            <div class="relative">
              <input type="checkbox" 
                     name="isDefault" 
                     class="sr-only peer">
              <div class="w-6 h-6 border-2 border-gray-600 rounded-lg flex items-center justify-center 
                         peer-checked:bg-[#d4af37] peer-checked:border-[#d4af37] transition-all duration-300
                         group-hover/checkbox:border-[#d4af37]">
                <svg class="w-4 h-4 text-black opacity-0 peer-checked:opacity-100 transition-opacity" 
                     fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                </svg>
              </div>
            </div>
            <div>
              <span class="font-medium text-white">Set as default address</span>
              <p class="text-sm text-gray-500 mt-0.5">This will be your primary delivery address</p>
            </div>
          </label>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="flex justify-end gap-4 mt-8 pt-6 border-t border-[#2a2a2a]">
        <button type="button" 
                onclick="closeAddModal()"
                class="px-8 py-3 border-2 border-[#2a2a2a] text-gray-400 font-medium rounded-xl hover:bg-[#1a1a1a] hover:text-white transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]">
          Cancel
        </button>
        <button type="submit"
                class="px-8 py-3 bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black font-semibold rounded-xl 
                       hover:shadow-xl hover:shadow-[#d4af37]/20 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]">
          Save Address
        </button>
      </div>
    </form>
  </div>
</div>


  <!-- EDIT ADDRESS MODAL -->
<div id="editModal"
  class="fixed inset-0 bg-black/80 hidden flex items-center justify-center z-50 p-4 backdrop-blur-sm">

    <div class="bg-gradient-to-br from-[#0b0b0b] to-[#151515] w-full max-w-2xl rounded-2xl shadow-2xl border border-[#2a2a2a] animate-fade-in">
      <!-- Modal Header -->
      <div class="flex items-center justify-between p-6 border-b border-[#2a2a2a]">
        <div>
          <h3 class="text-2xl font-bold text-white">Edit Address</h3>
          <p class="text-gray-400 mt-1">Update your delivery address</p>
        </div>
        <button onclick="closeEditModal()"
                class="p-2 rounded-lg hover:bg-[#1a1a1a] transition-colors">
          <svg class="w-6 h-6 text-gray-400 hover:text-[#d4af37]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <!-- Modal Form -->
      <form id="editForm" method="POST" class="p-6 max-h-[70vh] overflow-y-auto custom-scrollbar">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Full Name -->
          <div>
            <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
              Full Name *
            </label>
            <input type="text" 
                   id="e_fullName" 
                   name="fullName" 
                   
                   class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                          focus:border-[#d4af37] focus:outline-none transition duration-300">
          </div>

          <!-- Phone -->
          <div>
            <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
              Phone Number *
            </label>
            <input type="tel" 
                   id="e_phone" 
                   name="phone" 
                   
                   class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                          focus:border-[#d4af37] focus:outline-none transition duration-300">
          </div>
          <!-- Alternate Phone for EDIT MODAL -->
<div>
  <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
    Alternate Phone
  </label>
  <input type="tel" 
         id="e_alternatePhone" 
         name="alternatePhone"
         class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white">
  <p class="text-xs text-gray-500 mt-1">Must be different from primary phone</p>
</div>

          <!-- Address Line 1 -->
          <div class="md:col-span-2">
            <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
              Address Line 1 *
            </label>
            <input type="text" 
                   id="e_addressLine1" 
                   name="addressLine1" 
                   
                   class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                          focus:border-[#d4af37] focus:outline-none transition duration-300">
          </div>

          <!-- Address Line 2 -->
          <div class="md:col-span-2">
            <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
              Address Line 2 (Optional)
            </label>
            <input type="text" 
                   id="e_addressLine2" 
                   name="addressLine2"
                   class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                          focus:border-[#d4af37] focus:outline-none transition duration-300">
          </div>

          <!-- City -->
          <div>
            <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
              City *
            </label>
            <input type="text" 
                   id="e_city" 
                   name="city" 
                   
                   class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                          focus:border-[#d4af37] focus:outline-none transition duration-300">
          </div>

          <!-- State -->
        <!-- State Dropdown -->
<div>
  <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
    State/Province *
  </label>
  <select name="state" 
   id="e_state"
          
          class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                 focus:border-[#d4af37] focus:outline-none transition duration-300
                 hover:border-[#d4af37]/50 appearance-none cursor-pointer">
    <option value="" class="bg-[#0b0b0b] text-gray-400">Select State</option>
    <option value="Alabama" class="bg-[#0b0b0b] text-white">Alabama</option>
    <option value="Alaska" class="bg-[#0b0b0b] text-white">Alaska</option>
    <option value="Arizona" class="bg-[#0b0b0b] text-white">Arizona</option>
    <option value="Arkansas" class="bg-[#0b0b0b] text-white">Arkansas</option>
    <option value="California" class="bg-[#0b0b0b] text-white">California</option>
    <!-- Add more states as needed -->
  </select>
</div>

          <!-- Postal Code -->
        <!-- Postal Code -->
<div>
  <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
    Postal Code *
  </label>
  <input type="text" 
         name="postalCode" 
          id="e_postalCode"
         placeholder="10001" 
         
         pattern="^\d{5}$"
         title="Postal code must be exactly 5 digits"
         maxlength="5"
         oninput="this.value = this.value.replace(/[^0-9]/g, '')"
         class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                focus:border-[#d4af37] focus:outline-none transition duration-300
                hover:border-[#d4af37]/50">
  <p class="text-xs text-gray-500 mt-1">Exactly 5 digits </p>
</div>

          <!-- Country -->
          <div>
            <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
              Country *
            </label>
            <select id="e_country" 
                    name="country"
                  
                    
                    class="w-full px-4 py-3 bg-[#0b0b0b]/50 border border-[#2a2a2a] rounded-xl text-white placeholder-gray-500 
                           focus:border-[#d4af37] focus:outline-none transition duration-300 appearance-none cursor-pointer">
              <option value="" class="bg-[#0b0b0b] text-gray-400">Select Country</option>
              <option value="United States" class="bg-[#0b0b0b] text-white">United States</option>
              <option value="Canada" class="bg-[#0b0b0b] text-white">Canada</option>
              <option value="United Kingdom" class="bg-[#0b0b0b] text-white">United Kingdom</option>
              <option value="Australia" class="bg-[#0b0b0b] text-white">Australia</option>
              <option value="India" class="bg-[#0b0b0b] text-white">India</option>
            </select>
          </div>

          <!-- Address Type -->
          <div class="md:col-span-2">
            <label class="block text-sm font-semibold tracking-wider text-gray-400 mb-2 uppercase">
              Address Type
            </label>
            <div class="grid grid-cols-3 gap-3">
              <label class="relative">
                <input type="radio" id="e_type_home" name="addressType" value="home" class="sr-only peer">
                <div class="flex flex-col items-center p-4 border-2 border-[#2a2a2a] rounded-xl cursor-pointer transition-all duration-300 
                           peer-checked:border-[#d4af37] peer-checked:bg-[#d4af37]/5 hover:border-[#d4af37]/50">
                  <svg class="w-8 h-8 mb-2 text-gray-500 peer-checked:text-[#d4af37]" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
                  </svg>
                  <span class="text-sm font-medium text-gray-300 peer-checked:text-[#d4af37]">Home</span>
                </div>
              </label>
              
              <label class="relative">
                <input type="radio" id="e_type_work" name="addressType" value="work" class="sr-only peer">
                <div class="flex flex-col items-center p-4 border-2 border-[#2a2a2a] rounded-xl cursor-pointer transition-all duration-300 
                           peer-checked:border-[#d4af37] peer-checked:bg-[#d4af37]/5 hover:border-[#d4af37]/50">
                  <svg class="w-8 h-8 mb-2 text-gray-500 peer-checked:text-[#d4af37]" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M6 6V5a3 3 0 013-3h2a3 3 0 013 3v1h2a2 2 0 012 2v3.57A22.952 22.952 0 0110 13a22.95 22.95 0 01-8-1.43V8a2 2 0 012-2h2zm2-1a1 1 0 011-1h2a1 1 0 011 1v1H8V5zm1 5a1 1 0 011-1h.01a1 1 0 110 2H10a1 1 0 01-1-1z" clip-rule="evenodd"/>
                    <path d="M2 13.692V16a2 2 0 002 2h12a2 2 0 002-2v-2.308A24.974 24.974 0 0110 15c-2.796 0-5.487-.46-8-1.308z"/>
                  </svg>
                  <span class="text-sm font-medium text-gray-300 peer-checked:text-[#d4af37]">Work</span>
                </div>
              </label>
              
              <label class="relative">
                <input type="radio" id="e_type_other" name="addressType" value="other" class="sr-only peer">
                <div class="flex flex-col items-center p-4 border-2 border-[#2a2a2a] rounded-xl cursor-pointer transition-all duration-300 
                           peer-checked:border-[#d4af37] peer-checked:bg-[#d4af37]/5 hover:border-[#d4af37]/50">
                  <svg class="w-8 h-8 mb-2 text-gray-500 peer-checked:text-[#d4af37]" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                  </svg>
                  <span class="text-sm font-medium text-gray-300 peer-checked:text-[#d4af37]">Other</span>
                </div>
              </label>
            </div>
          </div>

          <!-- Set as Default -->
          <div class="md:col-span-2">
            <label class="flex items-center gap-3 p-4 border border-[#2a2a2a] rounded-xl cursor-pointer hover:bg-[#1a1a1a] transition-all duration-300 group/checkbox">
              <div class="relative">
                <input type="checkbox" 
                       id="e_isDefault" 
                       name="isDefault" 
                       class="sr-only peer">
                <div class="w-6 h-6 border-2 border-gray-600 rounded-lg flex items-center justify-center 
                           peer-checked:bg-[#d4af37] peer-checked:border-[#d4af37] transition-all duration-300
                           group-hover/checkbox:border-[#d4af37]">
                  <svg class="w-4 h-4 text-black opacity-0 peer-checked:opacity-100 transition-opacity" 
                       fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                  </svg>
                </div>
              </div>
              <div>
                <span class="font-medium text-white">Set as default address</span>
                <p class="text-sm text-gray-500 mt-0.5">This will be your primary delivery address</p>
              </div>
            </label>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="flex justify-end gap-4 mt-8 pt-6 border-t border-[#2a2a2a]">
          <button type="button" 
                  onclick="closeEditModal()"
                  class="px-8 py-3 border-2 border-[#2a2a2a] text-gray-400 font-medium rounded-xl hover:bg-[#1a1a1a] hover:text-white transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]">
            Cancel
          </button>
          <button type="submit"
                  class="px-8 py-3 bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-black font-semibold rounded-xl 
                         hover:shadow-xl hover:shadow-[#d4af37]/20 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]">
            Update Address
          </button>
        </div>
      </form>
    </div>
  </div>
  <script>
  window.ADDRESSES = <%- JSON.stringify(addresses) %>;
</script>

</main>

<!-- Custom Styles -->
<style>
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.3s ease-out;
  }

  .address-type-option {
    @apply flex flex-col items-center p-4 border-2 border-gray-200 rounded-xl cursor-pointer transition-all duration-200;
  }

  .address-type-option svg {
    @apply text-gray-400;
  }

  input[type="radio"]:checked + .address-type-option {
    @apply border-indigo-500 bg-indigo-50;
  }

  input[type="radio"]:checked + .address-type-option svg {
    @apply text-indigo-600;
  }

  /* Custom scrollbar for modals */
  .overflow-y-auto {
    scrollbar-width: thin;
    scrollbar-color: #c7d2fe #f1f5f9;
  }

  .overflow-y-auto::-webkit-scrollbar {
    width: 6px;
  }

  .overflow-y-auto::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 3px;
  }

  .overflow-y-auto::-webkit-scrollbar-thumb {
    background-color: #c7d2fe;
    border-radius: 3px;
  }
</style>

<script>

</script>